From: Jeremy Bicha <jbicha@ubuntu.com>
Date: Thu, 14 Sep 2017 09:23:42 -0400
Subject: region: Add Language Selector button

Workaround for https://launchpad.net/bugs/1631750
---
 panels/system/region/cc-region-page.c  | 20 ++++++++++++++++++++
 panels/system/region/cc-region-page.ui | 22 ++++++++++++++++++++++
 2 files changed, 42 insertions(+)

diff --git a/panels/system/region/cc-region-page.c b/panels/system/region/cc-region-page.c
index e354faa..25a1431 100644
--- a/panels/system/region/cc-region-page.c
+++ b/panels/system/region/cc-region-page.c
@@ -572,6 +572,25 @@ setup_language_section (CcRegionPage *self)
         update_region_from_setting (self);
 }
 
+static void
+show_language_support (CcRegionPage *self)
+{
+        g_autoptr(GAppInfo) app_info = NULL;
+        g_autoptr(GdkAppLaunchContext) ctx = NULL;
+        g_autoptr(GError) error = NULL;
+
+        app_info = G_APP_INFO (g_desktop_app_info_new ("gnome-language-selector.desktop"));
+
+        if (app_info == NULL) {
+                g_warning ("Failed to launch language-selector: couldn't create GDesktopAppInfo");
+                return;
+        }
+
+        ctx = gdk_display_get_app_launch_context (gdk_display_get_default ());
+        if (!g_app_info_launch (app_info, NULL, G_APP_LAUNCH_CONTEXT (ctx), &error))
+                g_warning ("Failed to launch language-selector: %s", error->message);
+}
+
 static void
 update_login_region (CcRegionPage *self)
 {
@@ -851,6 +870,7 @@ cc_region_page_class_init (CcRegionPageClass * klass)
         gtk_widget_class_bind_template_callback (widget_class, on_user_formats_row_activated_cb);
         gtk_widget_class_bind_template_callback (widget_class, on_user_language_row_activated_cb);
         gtk_widget_class_bind_template_callback (widget_class, restart_now);
+        gtk_widget_class_bind_template_callback (widget_class, show_language_support);
 }
 
 static void
diff --git a/panels/system/region/cc-region-page.ui b/panels/system/region/cc-region-page.ui
index 800a8fa..dd1c5d3 100644
--- a/panels/system/region/cc-region-page.ui
+++ b/panels/system/region/cc-region-page.ui
@@ -25,6 +25,28 @@
             <child>
               <object class="AdwPreferencesPage">
                 <property name="description" translatable="yes">The language setting is used for interface text and web pages. Formats are used for numbers, dates, and currencies.</property>
+                <child>
+                  <object class="AdwPreferencesGroup">
+                    <property name="title" translatable="yes">System</property>
+
+                    <child>
+                      <object class="AdwActionRow">
+                        <property name="use-underline">True</property>
+                        <property name="title" translatable="yes">Manage Installed Languages</property>
+                        <property name="activatable">True</property>
+                        <signal name="activated" handler="show_language_support" object="CcRegionPage" swapped="yes" />
+
+                        <child>
+                          <object class="GtkImage">
+                            <property name="valign">center</property>
+                            <property name="icon-name">go-next-symbolic</property>
+                          </object>
+                        </child>
+                      </object>
+                    </child>
+
+                  </object>
+                </child>
                 <child>
                   <object class="AdwPreferencesGroup">
                     <property name="title" translatable="yes">Your Account</property>
